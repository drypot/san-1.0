/*                                               */
/*                                               */
/*        Han-Gul Code Convert version 1.0       */
/*                                               */
/*        programed by Magic Book                */
/*                                               */
/*                                               */

#include "StdDef.h"
#include "HanConv.h"

byte HanCodeTable[]=
      "ˆaˆbˆeˆhˆiˆjˆkˆqˆsˆtˆuˆvˆwˆxˆyˆ{ˆ|ˆ}ˆˆ‚ˆ…ˆ‰ˆ‘ˆ“ˆ•ˆ–ˆ—"
      "ˆ¡ˆ¢ˆ¥ˆ©ˆµˆ·ˆÁˆÅˆÉˆáˆâˆåˆèˆéˆëˆñˆóˆõˆöˆ÷ˆøˆûˆüˆý"
      "‰A‰E‰I‰Q‰S‰U‰V‰W‰a‰b‰c‰e‰h‰i‰q‰s‰u‰v‰w‰{‰‰…‰‰‰“‰•"
      "‰¡‰¢‰¥‰¨‰©‰«‰­‰°‰±‰³‰µ‰·‰¸‰Á‰Â‰Å‰É‰Ë‰Ñ‰Ó‰Õ‰×‰á‰å‰é‰ñ‰ö‰÷"
      "ŠAŠBŠEŠIŠQŠSŠUŠWŠaŠeŠiŠsŠuŠŠ‚Š…ŠˆŠ‰ŠŠŠ‹ŠŠ‘Š“Š•Š—Š˜"
      "Š¡Š¢Š¥Š©Š¶Š·ŠÁŠÕŠáŠâŠåŠéŠñŠóŠõ"
      "‹A‹E‹I‹a‹b‹e‹h‹i‹j‹q‹s‹u‹w‹‹¡‹¢‹¥‹¨‹©‹«‹±‹³‹µ‹·‹¸‹¼"
      "ŒaŒbŒcŒeŒiŒkŒqŒsŒuŒvŒwŒ{ŒŒ‚Œ…Œ‰Œ‘Œ“Œ•Œ–Œ—"
      "Œ¡Œ¢Œ©ŒáŒâŒãŒåŒéŒñŒóŒõŒöŒ÷"
      "ABEQUWaeiuv{¡¢¥§©±³µ·¸¹"
      "ÁÂÉÖ×áâ÷"
      "ŽAŽEŽIŽQŽSŽWŽaŽŽ‚Ž…Ž‰ŽŽ‘Ž“Ž•Ž—Ž˜"
      "Ž¡Ž©Ž¶Ž·ŽÁŽÂŽÅŽÉŽÑŽÓŽÖŽáŽåŽéŽñŽó"
      "Aabegikpqsuw{¡¢¥©±³µ·"
      "abcehijkqsuvwxy{}‚…‰‘“•–—"
      "¡¢¥©±·áâäåéëìñóõö÷ý"
      "‘A‘B‘E‘I‘Q‘S‘U‘V‘W‘a‘b‘e‘i‘q‘s‘v‘w‘z‘‘…"
      "‘¡‘¢‘¥‘©‘«‘±‘³‘µ‘·‘¼‘½‘Á‘Å‘É‘Ö"
      "’A’E’I’Q’S’U’a’b’e’i’s’u’w’’‚’…’ˆ’‰’‘’“’•’—’¡’¶’Á’á’å’é’ñ’ó"
      "“A“B“I“Q“S“W“a“b“e“i“j“k“q“s“u“w“x“|““…“‰“¡“¢“¥“©“¯“±“³“µ“·“¼"
      "”a”b”c”e”h”i”j”k”l”p”q”s”u”v”w”x”y”}””‚”…”‰”‘”“”•”–”—"
      "”¡”á”â”ã”å”è”é”ë”ì”ñ”ó”õ”÷”ù”ü"
      "•A•B•E•I•Q•S•U•V•W•a•e•i•v•w••…•¡•¢•¥•¨•©•«•­•±•³•µ•·•¹•»"
      "•Á•Å•É•á•ö"
      "–A–E–I–Q–S–U–a––‚–…–‰–‘–“–•–—–¡–¶–Á–×–á–å–é–ó–õ–÷"
      "—A—E—I—Q—W—a—b—e—h—i—k—q—s—u—w——¡—¢—¥—¨—©—±—³—µ—¶—·—¸"
      "˜a˜b˜e˜i˜q˜s˜u˜v˜w˜}˜˜‚˜…˜‰˜‘˜“˜•˜–˜—˜á˜â˜å˜é˜ë˜ì˜ñ˜ó˜õ˜ö˜÷˜ý"
      "™A™B™E™I™Q™S™U™V™W™a™v™¡™¢™¥™©™·™Á™É™á"
      "šAšEšš‚š…š‰šš‘š—šÁšášåšéšñšóš÷"
      "›a›b›e›h›i›q›s›u››…›‰›‘›“›¡›¥›©›±›³›µ›·"
      "œaœbœeœiœqœsœuœvœwœxœ|œ}œœ‚œ…œ‰œ‘œ“œ•œ–œ—"
      "œ¡œ¢œ¥œµœ·œáœâœåœéœñœóœõœöœ÷œý"
      "ABEIQSUWabeiqsuvw…“•¡¢¥©±³µ·"
      "ÁÅ×ö"
      "žAžEžIžQžSžUžWžažežižsžužwžž‚ž…ž‰ž‘ž“ž•ž—ž¡ž¶žÁžážâžåžéžñžõž÷"
      "ŸAŸBŸEŸIŸQŸSŸUŸWŸaŸbŸeŸiŸqŸsŸuŸwŸxŸ{Ÿ|Ÿ¡Ÿ¢Ÿ¥Ÿ©Ÿ±Ÿ³ŸµŸ·"
      " a b e g h i j k q s u w x { }  ‚ … ‰ ‘ “ • – — ˜"
      " ¡ ¢ © · á â å é ë ñ ó õ ÷ ø ý"
      "¡A¡B¡E¡I¡Q¡S¡U¡V¡W¡a¡b¡e¡i¡u¡v¡w¡y¡¡¡¡¢¡¤¡¥¡©¡«¡±¡³¡µ¡·¡Á¡Å¡Ö¡×"
      "¢A¢E¢I¢S¢U¢W¢a¢e¢i¢s¢u¢¢‚¢ƒ¢…¢ˆ¢‰¢Š¢‹¢‘¢“¢•¢—¢›¢"
      "¢¡¢¥¢©¢³¢µ¢Á¢á¢å¢é"
      "£A£E£I£Q£U£a£e£i£q£u£¡£¢£¥£¨£©£«£±£³£µ£¶£·£¹£»"
      "¤a¤b¤c¤d¤e¤h¤i¤j¤k¤l¤q¤s¤u¤w¤{¤¤‚¤…¤‰¤‘¤“¤•¤–¤—¤›"
      "¤¡¤¢¤¥¤³¤á¤â¤å¤è¤é¤ë¤ñ¤ó¤õ¤÷¤ø"
      "¥A¥B¥E¥H¥I¥Q¥S¥U¥V¥W¥a¥b¥e¥i¥s¥u¥v¥w¥{"
      "¥¥…¥¡¥¢¥£¥¥¥©¥±¥³¥µ¥·¥Á¥Å¥Ö¥á¥ö"
      "¦A¦B¦E¦I¦Q¦S¦a¦e¦¦‚¦…¦ˆ¦‰¦Š¦‹¦‘¦“¦•¦—¦›¦œ¦¡¦©¦¶¦Á¦á¦â¦å¦é¦÷"
      "§A§E§I§Q§U§W§a§b§e§i§q§s§u§¡§¢§¥§©§«§±§³§µ§·§¸§¹"
      "¨a¨b¨e¨i¨k¨q¨s¨u¨v¨w¨}¨¨‚¨…¨‰¨‘¨“¨•¨–¨—¨¡¨¢¨±¨á¨â¨å¨è¨é¨ñ¨õ¨ö¨÷"
      "©A©W©a©b©q©s©u©v©w©¡©¢©¥©©©±©³©·"
      "ªAªaªwªª‚ª…ª‰ª‘ª•ª—"
      "«A«W«a«e«i«q«s«¡«¢«¥«©«±«³«µ«·"
      "¬a¬b¬d¬e¬h¬i¬j¬k¬q¬s¬u¬v¬w¬{¬¬‚¬…¬‰¬‘¬“¬•¬–¬—¬¡¬¢¬¥¬©¬±¬³¬µ¬·"
      "¬Á¬Å¬É¬Ñ¬×¬á¬â¬ã¬ä¬å¬è¬é¬ë¬ì¬ñ¬ó¬õ¬ö¬÷¬ü"
      "­A­B­E­I­Q­S­U­V­W­a­b­e­i­q­s­u­v­w­­…­‰­—"
      "­¡­¢­£­¥­©­«­±­³­µ­·­»­Á­Â­Å­É­×­á­å­é­ñ­õ­ö"
      "®A®E®I®Q®S®U®a®b®e®i®q®s®u®w®®‚®…®ˆ®‰®‘®“®•®—®™®›®œ"
      "®¡®¶®Á®Â®Å®É®Ñ®×®á®â®å®é®ñ®ó®õ®÷"
      "¯A¯B¯I¯Q¯U¯W¯a¯b¯e¯i¯j¯q¯s¯u¯w¯¡¯¢¯¥¯¨¯©¯°¯±¯³¯µ¯·¯¼"
      "°a°b°d°e°i°q°s°v°w°}°°‚°…°‰°‘°“°–°—°·°á°â°å°é°ë°ñ°ó°ö°÷"
      "±A±E±I±W±¡±¢±¥±¨±©±«±±±³±·±Á±Â±Å±Ö±á±ö"
      "²A²E²I²Q²S²a²²‚²…²‰²‘²“²—²¡²¶²Á²á²å"
      "³W³a³b³e³i³k³p³q³s³³…³‰³‘³¡³¢³¥³©³±³³³µ³·"
      "´a´b´e´f´g´i´j´k´p´q´s´u´v´w´{´|´´‚´…´‰´‘´“´•´–´—"
      "´¡´¢´¥´©´¬´±´³´µ´·´»´½´Á´Å´É´Ó´á´â´å´æ´è´é´ê´ë´ñ´ó´ô´õ´ö´÷´ø´ú´ü"
      "µAµBµEµIµQµSµUµWµaµbµcµeµiµkµlµqµsµtµuµvµwµ{µ|µ}µµ…µ‰µ‘µ“µ•µ–"
      "µ¡µ¢µ¥µ©µªµ«µ­µ°µ±µ³µµµ·µ¹µÁµÂµÅµÉµÑµÓµÕµÖµ×µáµâµåµñµõµ÷"
      "¶A¶B¶E¶I¶Q¶S¶U¶W¶a¶b¶e¶i¶q¶s¶u¶w¶¶‚¶…¶‰¶Š¶‹¶‘¶“¶•¶—"
      "¶¡¶¢¶¥¶©¶±¶³¶¶¶·¶Á¶Â¶Å¶É¶Ñ¶Ó¶×¶á¶â¶å¶é¶ñ¶ó¶õ¶÷"
      "·A·B·E·I·Q·S·U·W·Y·a·b·e·i·o·q·s·u·w·x·y·z·{·|·}"
      "··…·‰·‘·•·¡·¢·¥·©·ª·«·°·±·³·µ·¶···¸·¼"
      "¸a¸b¸e¸g¸h¸i¸k¸q¸s¸u¸v¸w¸x¸¸‚¸…¸‰¸‘¸“¸•¸–¸—"
      "¸¡¸¢¸¥¸§¸©¸±¸·¸Á¸Å¸É¸á¸â¸å¸é¸ë¸ñ¸ó¸õ¸÷¸ø"
      "¹A¹B¹E¹I¹Q¹S¹U¹W¹a¹e¹i¹q¹s¹v¹w¹¹¡¹¢¹¥¹©¹«¹±¹³¹µ¹·¹¸¹¹¹½"
      "¹Á¹Â¹É¹Ó¹Õ¹×¹á¹ö¹÷"
      "ºAºEºIºQºSºUºWºaºbºeºwºº‚º…º‰ºŠº‹º‘º“º•º—º¡º¶ºÁºáºâºåºéºñºóºõ"
      "»A»E»I»Q»a»b»e»i»q»s»u»w»¡»¢»¥»¨»©»«»±»³»µ»·»¸»»»¼"
      "¼a¼b¼e¼g¼i¼l¼q¼s¼u¼v¼w¼¼‚¼…¼‰¼‘¼“¼•¼–¼—¼¡¼¥¼·¼á¼â¼å¼é¼ñ¼ó¼õ¼ö¼÷"
      "½A½W½a½v½¡½¢½¥½©½±½³½µ½·½¹½Á½Â½É½Ö½á½ö"
      "¾A¾E¾I¾Q¾S¾w¾¾‚¾…¾‰¾‘¾“¾—¾¡¾¶¾·¾á"
      "¿A¿a¿q¿u¿w¿¡¿¢¿¥¿©¿±¿³¿·¿¸¿½"
      "ÀaÀbÀeÀgÀiÀqÀsÀuÀvÀwÀxÀÀ‚À…À‰À‘À“À•À–À—"
      "À¡À¥À§À©À±À·ÀáÀâÀåÀéÀñÀóÀõÀöÀ÷"
      "ÁAÁBÁEÁIÁQÁSÁUÁWÁaÁeÁvÁÁ…Á—Á¡Á¢Á¥Á©Á±Á³ÁµÁ·ÁÁÁÅÁÉÁ×"
      "ÂAÂEÂIÂQÂSÂUÂWÂaÂqÂÂ‚Â…Â‰Â‘Â“Â•Â—Â¡Â¶ÂÁÂÅÂáÂåÂéÂñÂóÂõÂ÷"
      "ÃAÃEÃIÃQÃWÃaÃbÃeÃiÃqÃsÃuÃwÃ¡Ã¢Ã¥Ã¨Ã©ÃªÃ±Ã³ÃµÃ·"
      "ÄaÄbÄeÄiÄqÄsÄuÄwÄÄ‚Ä…Ä‰Ä‘Ä“Ä•Ä–Ä—Ä¡Ä¢Ä·ÄáÄâÄåÄèÄéÄñÄóÄõÄöÄ÷"
      "ÅAÅBÅEÅIÅQÅSÅUÅWÅaÅeÅiÅqÅsÅuÅvÅwÅÅ¡Å¢Å¥Å©Å±Å³ÅµÅ·ÅÁÅÂÅÅÅÉÅÑÅ×ÅáÅ÷"
      "ÆAÆIÆaÆÆ‚Æ…Æ‰Æ‘Æ“Æ•Æ—Æ¡Æ¥Æ©Æ·ÆÁÆ×ÆáÆâÆåÆéÆñÆóÆõÆ÷"
      "ÇAÇEÇIÇQÇaÇbÇeÇiÇqÇsÇwÇ¡Ç¢Ç¥Ç©Ç±Ç³ÇµÇ·"
      "ÈaÈbÈeÈiÈjÈqÈsÈuÈvÈwÈÈ‚È…È‰È‘È“È•È–È—È¡È·ÈáÈâÈåÈéÈëÈñÈóÈõÈöÈ÷"
      "ÉAÉBÉEÉIÉQÉSÉUÉWÉaÉeÉvÉÉ…É¡É¢É¥É©É±É³ÉµÉ·É¼ÉÁÉÅÉá"
      "ÊAÊEÊUÊWÊaÊÊ‚Ê…Ê‰Ê‘Ê“Ê•Ê—Ê¡Ê¶ÊÁÊáÊâÊåÊéÊñÊóÊ÷"
      "ËAËEËIËQËWËaËbËeËhËiËkËqËsËuËË…Ë‰Ë‘Ë“Ë¡Ë¢Ë¥Ë©Ë±Ë³ËµË·"
      "ÌaÌbÌcÌeÌiÌkÌqÌsÌuÌvÌwÌ{ÌÌ‚Ì…Ì‰Ì‘Ì“Ì•Ì–Ì—Ì¡Ì¢ÌáÌâÌåÌéÌñÌóÌõÌöÌ÷"
      "ÍAÍBÍEÍIÍQÍSÍUÍWÍaÍeÍiÍqÍsÍvÍwÍÍ‰Í“Í•Í¡Í¢Í¥Í©Í±Í³ÍµÍ·ÍÁÍ×"
      "ÎAÎEÎaÎeÎiÎsÎuÎÎ‚Î…ÎˆÎ‰Î‹Î‘Î“Î•Î—Î¡Î·ÎáÎåÎéÎñÎõ"
      "ÏAÏEÏIÏQÏUÏWÏaÏeÏiÏqÏsÏuÏ¡Ï¢Ï¥Ï©Ï±Ï³ÏµÏ·"
      "ÐaÐbÐeÐiÐnÐqÐsÐuÐwÐÐ‚Ð…Ð‰Ð‘Ð“Ð•Ð–Ð—Ð¡Ð·ÐáÐâÐåÐéÐëÐñÐóÐõÐ÷"
      "ÑAÑBÑEÑIÑQÑSÑUÑWÑaÑbÑeÑiÑqÑsÑuÑvÑwÑÑ…Ñ‰Ñ“"
      "Ñ¡Ñ¢Ñ¥Ñ©Ñ®Ñ±Ñ³ÑµÑ·Ñ»ÑÁÑÂÑÅÑÉÑÕÑ×ÑáÑâÑåÑõÑ÷"
      "ÒAÒBÒEÒIÒSÒUÒWÒaÒeÒiÒsÒuÒÒ‚Ò…Ò‰ÒŽÒ‘Ò•Ò—"
      "Ò¡Ò¥Ò©Ò±Ò·ÒÁÒÂÒÅÒÉÒ×ÒáÒâÒåÒéÒñÒóÒõÒ÷"
      "ÓAÓBÓEÓIÓQÓUÓWÓaÓbÓeÓgÓhÓiÓjÓqÓsÓuÓwÓ{"
      "ÓÓ…Ó‰Ó‘Ó“Ó—Ó¡Ó¢Ó¥Ó©Ó±Ó³ÓµÓ·";

byte  FixedGrfTable[]=
      "¡¡¡Ù¡Ú¢¾¡ß¢À¢¼¡Ü¡à¡Û¡á¡Î¡Ï¢Ü¢Ý¢´¢º¢¸¢Õ£¡¢Ò¡×¡ª¢Ù¡è¡é¡æ¡ç¡Ð¡ê"
      "¡ã¡åìíêÅûýâ©ÙÊÐÝ÷ÏÒ´¢Ï¡¸¡¹¨ö¨ù£ß¡­¡Å¢Æ¢Ç¢È¦¢¦©¦¾¦¹¦Á¦Â¦´¦­¦¯"
      "¦°¦Ã¦Ä¦¤¦¦¦ª¦¨¦§¦¡¦«¦¼¦·¦±¦®¦µ¦³¦²¦¬¦¶¦º¦¿¦¸¦½¦Å¦Æ¦È¦Ç¦À¦»¦¥"
      "¦£¢Ã¢É¢Ê¢Ë¢Ì¥á©¬¥Ã¥ð¥Ò¥ò¥ì¥ó¥Õ¥è§Ù¥ä¡Ä©ª¡ô¡û¡Õ¡¾¡Ã¡Â¡ò¡ó¡À¢Í"
      "¡£¡¤¡ç¡î©ú©÷£Ü¡¡";

void far ToFixedChar (byte far *pos)
{
      byte far *mid;
      word start,end,index;

      if  (*pos>=0xe0) {
        if (*(pos+1)>0xa0) {
           *pos=(*pos-0xe0)*2+0xcb;
        } else {
           if (*(pos+1)>0x90) *(pos+1)=*(pos+1)-0x12+0x70;
           else               *(pos+1)=*(pos+1)+0x70;
           *pos=(*pos-0xe0)*2+0xca;
        }
        return;
      }

      if  (*pos==0xD4) {
          *pos    =FixedGrfTable[(*(pos+1) & 0x7F)*2  ];
          *(pos+1)=FixedGrfTable[(*(pos+1) & 0x7F)*2+1];
          return;
      } else if (*pos>=0xd9 && *pos<=0xde) {
          if (*(pos+1)>0xa0) {
             *pos=(*pos-0xd9)*2+0xa2;
          } else {
             if (*(pos+1)>0x90) *(pos+1)=*(pos+1)-0x12+0x70;
             else               *(pos+1)=*(pos+1)+0x70;
             *pos=(*pos-0xd9)*2+0xa1;
          }
          return;
      }

      start=0;
      end  =(sizeof(HanCodeTable)-1)/2-1;
      while (start<=end) {
         index=(start+end)/2;
         mid=HanCodeTable+index*2;
         if (*pos>*mid) start=index+1;
         else if (*pos<*mid) end=index-1;
         else if (*(pos+1)>*(mid+1))  start=index+1;
         else if (*(pos+1)<*(mid+1))  end=index-1;
         else {
              *pos    =(index/94)+0xB0;
              *(pos+1)=(index%94)+0xA1;
              return;
         }
      }
      *pos    =FixedGrfTable[0];
      *(pos+1)=FixedGrfTable[1];
}

void far ToCombiChar (byte far *pos)
{
      word index;

      if (*pos>0xc9) {
         if (*pos%2==0) {
            if (*(pos+1)>0xee) *(pos+1)=*(pos+1)-0x70+0x12;
            else               *(pos+1)=*(pos+1)-0x70;
            *pos=(*pos-0xca)/2+0xe0;
         } else {
            *pos=(*pos-0xca)/2+0xe0;
         }
         return;
      }

      if (*pos<0xAD) {
         if (*pos%2!=0) {
            if (*(pos+1)>0xee) *(pos+1)=*(pos+1)-0x70+0x12;
            else               *(pos+1)=*(pos+1)-0x70;
            *pos=(*pos-0xa1)/2+0xd9;
         } else {
            *pos=(*pos-0xa1)/2+0xd9;
         }
         return;
      }

      index =(word)(*pos-0xB0)*94;
      index+=((word)*(pos+1)-0xA1);
      *pos    =HanCodeTable[index*2];
      *(pos+1)=HanCodeTable[index*2+1];
}

void far ToFixed(char *Data,word Len)
{
   word i;

   for (i=0 ; i<Len ; )
     if ((byte)Data[i]<128) i++;
     else  ToFixedChar(Data+i),i+=2;
}

void far ToCombi(char *Data,word Len)
{
   word i;

   for (i=0 ; i<Len ; )
     if ((byte)Data[i]<128) i++;
     else  ToCombiChar(Data+i),i+=2;
}

